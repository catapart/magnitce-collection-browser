<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>&lt;collection-browser&gt; Demo</title>
    <link rel="stylesheet" href="./demo-page.css">
</head>
<body>
    <main class="centered-single-column">
        <header class="full-width">
            <div class="content centered-single-column">
                <h1>The <code>collection-browser</code> element</h1>
            </div>
        </header>
        <article class="overview">
            <h2>Overview</h2>
            <p>The <code>&lt;collection-browser&gt;</code> element is a container that manages a collection of children as a gallery of items for interaction.</p>
            <p>It provides selection events and an add button for invoking handlers to add new items to the collection.</p>
            <p>It also provides a <code>category</code> slot which can be used to filter the children, either with built-in handling, or by using custom event handlers.</p>
        </article>
        <article class="basic">
            <h2>Basic Examples</h2>
            <section class="embed">
                <style>
                    article.basic .embed collection-browser
                    {
                        margin: 1em;
                        width: 600px;
                    }
                </style>
                <h3>Embedded</h3>
                <div class="description">
                    <p>The <code>&lt;collection-browser&gt;</code> element can be used directly on the page, as an isolated gallery.</p>
                </div>
                <div class="example">
                    <collection-browser>
                        <div slot="category">Category 1</div>
                        <div slot="category">Category 2</div>
                        <div slot="category">Category 3</div>
                        <div slot="category">Category 4</div>
                        <div>A</div>
                        <div>B</div>
                        <div>C</div>
                        <div>D</div>
                        <div>E</div>
                    </collection-browser>
                </div>
            </section>
            <section class="dialog">
                <style>
                    article.basic .dialog collection-browser
                    {
                        width: 400px;
                    }
                    article.basic .dialog dialog
                    {
                        top: 50%;
                        flex-direction: column;
                    }
                    article.basic .dialog dialog[open]
                    {
                        display: flex;
                    }
                    article.basic .dialog dialog > header
                    ,article.basic .dialog dialog > form > header
                    {
                        display: flex;
                        align-items: center;
                        padding-bottom: 7px;
                    }
                    article.basic .dialog dialog > footer
                    ,article.basic .dialog dialog > form > footer
                    {
                        display: flex;
                        align-items: center;
                        justify-content: flex-end;
                        padding-top: 7px;
                    }
                </style>
                <h3>Dialog</h3>
                <div class="description">
                    <p>The <code>&lt;collection-browser&gt;</code> element can also be used within a <code>&lt;dialog&gt;</code> element to mimic a "File Browser".</p>
                    <p>Use the button, below, to open the dialog example. Note that this example's <code>&lt;collection-browser&gt;</code> element has a <code>multi</code> attribute, so multiple items may be selected.</p>    
                </div>
                <div class="example">
                    <dialog>
                        <form class="close-form" method="dialog">
                            <header>
                                <span class="title" style="flex:1;">Custom Collection Browser</span>
                                <span class="actions">
                                    <button type="submit">&times;</button>
                                </span>
                            </header>
                            <collection-browser multi>
                                <div slot="category">Category 1</div>
                                <div slot="category">Category 2</div>
                                <div slot="category">Category 3</div>
                                <div slot="category">Category 4</div>
                                <div>A</div>
                                <div>B</div>
                                <div>C</div>
                                <div>D</div>
                                <div>E</div>
                            </collection-browser>
                            <footer>
                                <button type="submit">Close</button>
                            </footer>
                        </form>
                    </dialog>
                    <button type="button" id="basic_openDialog">Open Browser</button>
                </div>
            </section>
            <section class="no-categories">
                <style>
                    article.basic .no-categories collection-browser
                    {
                        margin: 1em;
                        width: 600px;
                    }
                </style>
                <h3>No Categories</h3>
                <div class="description">
                    <p>The <code>&lt;collection-browser&gt;</code> element can be used without any categories, if items do not need to be filtered.</p>
                </div>
                <div class="example">
                    <collection-browser>
                        <div>A</div>
                        <div>B</div>
                        <div>C</div>
                        <div>D</div>
                        <div>E</div>
                    </collection-browser>
                </div>
            </section>
            <section class="no-add">
                <style>
                    article.basic .no-add collection-browser
                    {
                        margin: 1em;
                        width: 600px;
                    }
                    article.basic .no-add collection-browser::part(header)
                    {
                        display: none;
                    }
                </style>
                <h3>No Add Button</h3>
                <div class="description">
                    <p>The <code>&lt;collection-browser&gt;</code> element's "Add" button is in the <code>header</code> part, which can be removed by setting its <code>display</code> style property to <code>none</code>.</p>
                    <p>In this example, the entire <code>header</code> part has been hidden by setting its <code>display</code> value to <code>none</code>, rather than directly removing the "Add" button:</p>
                </div>
                <div class="example">
                    <collection-browser>
                        <div slot="category">Category 1</div>
                        <div slot="category">Category 2</div>
                        <div>A</div>
                        <div>B</div>
                        <div>C</div>
                        <div>D</div>
                        <div>E</div>
                    </collection-browser>
                </div>
            </section>
            <script type="module">
                const basicExample = document.querySelector('article.basic');
                // const basicBrowser = basicExample.querySelector('collection-browser');
                const basicDialog = basicExample.querySelector('dialog');
                const basicDialogButton = basicExample.querySelector('#basic_openDialog');
                document.addEventListener('DOMContentLoaded', () =>
                {
                    basicDialogButton.addEventListener('click', () =>
                    {
                        basicDialog.show();
                    });
                    // basicBrowser.addEventListener('change', (event) =>
                    // {
                    //     // event.preventDefault();
                    // });
                    // basicBrowser.addEventListener('close', (event) =>
                    // {
                    //     basicDialog.open = false; 
                    // });
                });                
            </script>
        </article>
        <article class="categories">
            <h2>Categories</h2>
            <div class="description">
                <p>The <code>&lt;collection-browser&gt;</code> element provides a slot with the name <code>category</code> as a method to navigate through, or filter the items in the collection browser.</p>
                <p>Category elements, like the item elements, can be any element type. To make an element a category, set it's <code>slot</code> attribute to <code>category</code>.</p>
                <p>Each category element will trigger a <code>category</code> event when it is clicked. It also has the default functionality of add <code>selected</code> to its own class list, as well as adding the class <code>has-category</code> to any item that matches the category's key.</p>
                <p>Matching is done with an exact string match of the <code>data-category</code> attribute for each category element and each item element. For default matching, set a category element's <code>data-category</code> value to any value, then set an item's <code>data-category</code> value to that same value. When the category is clicked, the item will get a <code>has-category</code> class.</p>
                <p>Items may use multiple category keys by separating them with a comma (<code>,</code>) character. For instance, an item with the attribute <code>data-category="a,b,c"</code> would match for any category that had a key of "a", "b", or "c".</p>
                <p>Default functionality can be prevented by handling the <code>category</code> event and calling the <code>preventDefault()</code> function on the event object.</p>
                <p>In this example, the <code>has-category</code> class adds a border so the filtered elements can be seen. To demonstrate multiple categories, the last three elements - J, K, and L - each use multiple categories so that they all match for category 4, but each match for another category, as well.</p>
                </div>
            <div class="example">
                <style>
                    article.categories collection-browser
                    {
                        margin: 1em;
                        width: 600px;
                    }
                    article.categories collection-browser .has-category
                    {
                        border: solid 1px highlight;
                    }
                </style>
                <collection-browser multi>
                    <div slot="category" data-category="1">Category 1</div>
                    <div slot="category" data-category="2">Category 2</div>
                    <div slot="category" data-category="3">Category 3</div>
                    <div slot="category" data-category="4">Category 4</div>
                    <div data-category="1">A</div>
                    <div data-category="1">B</div>
                    <div data-category="1">C</div>
                    <div data-category="2">D</div>
                    <div data-category="2">E</div>
                    <div data-category="2">F</div>
                    <div data-category="3">G</div>
                    <div data-category="3">H</div>
                    <div data-category="3">I</div>
                    <div data-category="1,4">J</div>
                    <div data-category="2,4">K</div>
                    <div data-category="3,4">L</div>
                </collection-browser>
            </div>
        </article>
        <article class="custom">
            <h2>The <code>&lt;captioned-thumbnail&gt;</code> and <code>&lt;collection-filter&gt;</code> elements</h2>
            <style>
                article.custom .captioned-thumbnail collection-browser
                {
                    width: 600px;
                }
                article.custom dialog
                {
                    position: fixed;
                    top: 50%;
                    translate: 0 -50%;
                    flex-direction: column;
                    /* margin: .5em minmax(.5em, auto) 0 minmax(.5em, auto);
                    max-width: calc(100vw - 1em);
                    max-height: calc(100vh - 1em); */
                }
                article.custom dialog[open]
                {
                    display: flex;
                }
                article.custom dialog > header
                ,article.custom dialog > form > header
                {
                    display: flex;
                    align-items: center;
                    padding-bottom: 7px;
                }
                article.custom dialog > footer
                ,article.custom dialog > form > footer
                {
                    display: flex;
                    align-items: center;
                    justify-content: flex-end;
                    padding-top: 7px;
                }

                article.custom .captioned-thumbnail  collection-browser captioned-thumbnail:not(.has-category)
                {
                    display: none;
                }
            </style>
            <section class="captioned-thumbnail">
                <h3>The <code>&lt;captioned-thumbnail&gt;</code> Element</h3>
                <div class="description">
                    <p>The <code>&lt;collection-browser&gt;</code> element can be used within a <code>&lt;dialog&gt;</code> element to mimic a "File Browser".</p>
                    <p>Use the button, below, to open the dialog example. Note that this example's <code>&lt;collection-browser&gt;</code> element has a <code>multi</code> attribute, so multiple items may be selected.</p>
                </div>
                <div class="example">
                    <dialog>
                        <form class="close-form" method="dialog">
                            <header>
                                <span class="title" style="flex:1;">Custom Collection Browser</span>
                                <span class="actions">
                                    <button type="submit">&times;</button>
                                </span>
                            </header>
                            <collection-browser>
                                <h5 slot="navigation-header">Drives</h5>
                                
                                <div slot="category" data-category="drive-1">Drive 1</div>
                                <div slot="category" data-category="drive-2">Drive 2</div>
                                <div slot="category" data-category="drive-3">Drive 3</div>
                                <div slot="category" data-category="drive-4">Drive 4</div>
    
                                <captioned-thumbnail edit select data-category="drive-1">First</captioned-thumbnail>
                                <captioned-thumbnail edit select data-category="drive-1">Second</captioned-thumbnail>
                                <captioned-thumbnail edit select data-category="drive-1">Third</captioned-thumbnail>
                                <captioned-thumbnail edit select data-category="drive-1">Fourth</captioned-thumbnail>
                                <captioned-thumbnail edit select data-category="drive-1">Fifth</captioned-thumbnail>
                                <captioned-thumbnail edit select data-category="drive-1">Sixth</captioned-thumbnail>
                                <captioned-thumbnail edit select data-category="drive-2">Seventh</captioned-thumbnail>
                                <captioned-thumbnail edit select data-category="drive-2">Eigth</captioned-thumbnail>
                                <captioned-thumbnail edit select data-category="drive-2">Ninth</captioned-thumbnail>
                                <captioned-thumbnail edit select data-category="drive-2">Tenth</captioned-thumbnail>
                                <captioned-thumbnail edit select data-category="drive-2">Eleventh</captioned-thumbnail>
                                <captioned-thumbnail edit select data-category="drive-2">Twelfth</captioned-thumbnail>
                                
                                <captioned-thumbnail edit select data-category="drive-3">Thirteenth</captioned-thumbnail>
                                <captioned-thumbnail edit select data-category="drive-3">Fourteenth</captioned-thumbnail>
                                <captioned-thumbnail edit select data-category="drive-3">Fifteenth</captioned-thumbnail>
                                <captioned-thumbnail edit select data-category="drive-3">Sixteenth</captioned-thumbnail>
                                <captioned-thumbnail edit select data-category="drive-3">Seventeenth</captioned-thumbnail>
                                <captioned-thumbnail edit select data-category="drive-3">Eighteenth</captioned-thumbnail>
                                <captioned-thumbnail edit select data-category="drive-4">Ninteenth</captioned-thumbnail>
                                <captioned-thumbnail edit select data-category="drive-4">Twentieth</captioned-thumbnail>
                                <captioned-thumbnail edit select data-category="drive-4">Twenty-First</captioned-thumbnail>
                                <captioned-thumbnail edit select data-category="drive-4">Twenty-Second</captioned-thumbnail>
                                <captioned-thumbnail edit select data-category="drive-4">Twenty-Third</captioned-thumbnail>
                                <captioned-thumbnail edit select data-category="drive-4">Twenty-Fourth</captioned-thumbnail>
                            </collection-browser>
                            <footer>
                                <span class="message" style="margin-right: auto;">
                                    <small><em><strong>Tip</strong>: Select multiple items by holding <key>Shift</key> or <key>Ctrl</key>, or by selecting with the checkboxes.</em></small>
                                </span>
                                <button type="submit">Close</button>
                            </footer>
                        </form>
                    </dialog>
                    <button type="button" id="custom_openThumbnail">Open Browser</button>
                </div>
            </section>
            <section class="collection-filter">
                <style>
                    .collection-filter:has(.match) captioned-thumbnail:not(.match)
                    {
                        opacity: .5;
                        order: 2;
                    }
                    .collection-filter captioned-thumbnail.match
                    {
                        border: solid 1px highlight;
                        order: 1;
                    }

                    .collection-filter .gallery > header
                    {
                        display: flex;
                        gap: 1em;
                        align-items: center;
                        background-color: infobackground;
                        color: infotext;
                        padding: .5em .25em;
                        border-top-left-radius: 3px;
                        border-top-right-radius: 3px;
                    }
                    .collection-filter .gallery collection-filter
                    {
                        flex: 1;
                    }

                    article.custom .collection-filter collection-browser
                    {
                        height: 300px;
                    }
                </style>
                <h3>The <code>&lt;collection-filter&gt;</code> Element</h3>
                <div class="description">
                    <p>The <code>&lt;collection-browser&gt;</code> element's items can be searched by adding the custom <code>&lt;collection-filter&gt;</code> element.</p>
                    <p>The <code>&lt;collection-filter&gt;</code> element prepares a query and then provides that query as <code>detail</code> data on an event. Using that data, the items can be filtered to present the browser's items in their most relevant order.</p>
                    <p>In the example below, the items that match the provided search term will be given a border and moved to the front of the collection, while the other items will have their opacity lowered.</p>
                    <p>Try searching for "teen", for example:</p>
                </div>
                <div class="example">
                    <div class="gallery">
                        <header>
                            <span class="title">Custom Collection Browser</span>
                            <collection-filter style="flex:1;"></collection-filter>
                        </header>
                        <collection-browser multi>
                            <captioned-thumbnail edit select>First</captioned-thumbnail>
                            <captioned-thumbnail edit select>Second</captioned-thumbnail>
                            <captioned-thumbnail edit select>Third</captioned-thumbnail>
                            <captioned-thumbnail edit select>Fourth</captioned-thumbnail>
                            <captioned-thumbnail edit select>Fifth</captioned-thumbnail>
                            <captioned-thumbnail edit select>Sixth</captioned-thumbnail>
                            <captioned-thumbnail edit select>Seventh</captioned-thumbnail>
                            <captioned-thumbnail edit select>Eigth</captioned-thumbnail>
                            <captioned-thumbnail edit select>Ninth</captioned-thumbnail>
                            <captioned-thumbnail edit select>Tenth</captioned-thumbnail>
                            <captioned-thumbnail edit select>Eleventh</captioned-thumbnail>
                            <captioned-thumbnail edit select>Twelfth</captioned-thumbnail>
                            
                            <captioned-thumbnail edit select>Thirteenth</captioned-thumbnail>
                            <captioned-thumbnail edit select>Fourteenth</captioned-thumbnail>
                            <captioned-thumbnail edit select>Fifteenth</captioned-thumbnail>
                            <captioned-thumbnail edit select>Sixteenth</captioned-thumbnail>
                            <captioned-thumbnail edit select>Seventeenth</captioned-thumbnail>
                            <captioned-thumbnail edit select>Eighteenth</captioned-thumbnail>
                            <captioned-thumbnail edit select>Ninteenth</captioned-thumbnail>
                            <captioned-thumbnail edit select>Twentieth</captioned-thumbnail>
                            <captioned-thumbnail edit select>Twenty-First</captioned-thumbnail>
                            <captioned-thumbnail edit select>Twenty-Second</captioned-thumbnail>
                            <captioned-thumbnail edit select>Twenty-Third</captioned-thumbnail>
                            <captioned-thumbnail edit select>Twenty-Fourth</captioned-thumbnail>
                        </collection-browser>
                    </div>
                </div>
            </section>
            <script type="module">
                import { CaptionedThumbnailElement } from './captioned-thumbnail.min.js';
                const customExample = document.querySelector('article.custom');

                const customThumbnailDialog = customExample.querySelector('.captioned-thumbnail dialog');
                const customThumbnailBrowser = customExample.querySelector('.captioned-thumbnail collection-browser');

                const customFilterDialog = customExample.querySelector('.collection-filter dialog');
                const customFilterBrowser = customExample.querySelector('.collection-filter collection-browser');
                const collectionFilter = customExample.querySelector('collection-filter');

                const customLog = document.querySelector('article.custom .log ul');

                const openThumbnailButton = document.querySelector('#custom_openThumbnail');
                document.addEventListener('DOMContentLoaded', () =>
                {
                    openThumbnailButton.addEventListener('click', () =>
                    {
                        customThumbnailDialog.show();
                    });

                    let lastSelectedElements = [];
                    customThumbnailBrowser.addEventListener('change', (event) =>
                    {
                        if(event.target instanceof CaptionedThumbnailElement)
                        {
                            // prevent the thumbnail from managing
                            // its own selection state
                            event.preventDefault();

                            if(event.detail.method == "click" || event.detail.method == "input")
                            {
                                // if checkbox was used for selection, allow multi-selection
                                // without needing to use ctrl or shift. if it was a click,
                                // require the key combinations
                                if(event.detail.method == "input")
                                {
                                    customThumbnailBrowser.dataset.multiSelect = true;
                                }
                                else
                                {
                                    customThumbnailBrowser.removeAttribute('data-allow-multiple');
                                }
                            }
                            else if (event.detail.method == 'Space' || event.detail.method == "Enter")
                            {
                                // if non-click method was used to select item
                            }
                        }

                        // if this change event is from the
                        // browser, manage the selections
                        if(event.target == customThumbnailBrowser)
                        {
                            // prevent the default state management
                            event.preventDefault();
                            
                            const { detail } = event;
                            const allowMultipleData = customThumbnailBrowser.dataset.multiSelect;
                            let allowMultiple = (allowMultipleData == "true");
                            if(allowMultiple == false)
                            {
                                const { shift, ctrl } = detail;
                                if(shift == true || ctrl == true)
                                {
                                    allowMultiple = true;
                                }
                            }
                            if(allowMultiple == false)
                            {
                                // de-select other captioned thumbnail elements 
                                // to prevent multiple selection
                                customThumbnailBrowser.deselectItems(...detail.previousSelection);
                                // detail.previousSelection.forEach(item => item.isSelected = false);
                            }

                            // set current selection
                            customThumbnailBrowser.selectItems(detail.newSelection);
                            // detail.newSelection.isSelected = !detail.newSelection.isSelected;
                            customThumbnailBrowser.removeAttribute('data-multi-select');
                        }
                    });

                    customFilterBrowser.addEventListener('change', (event) =>
                    {
                        if(event.target instanceof CaptionedThumbnailElement
                        && (event.detail.method == "click" || event.detail.method == "input"))
                        {
                            // an input event or a click event will trigger
                            // changes that the collection browser already handles.
                            // those events can be prevented on the thumbnail element.
                            event.preventDefault();
                        }
                        

                        // if this change event is from the
                        // browser, manage the selections
                        if(event.target == customFilterBrowser)
                        {
                            event.preventDefault();
                            // de-select other captioned thumbnail elements 
                            // to prevent multiple selection
                            event.detail.previousSelection.forEach(item => item.isSelected = false);

                            // set current selection
                            event.detail.newSelection.isSelected = !event.detail.newSelection.isSelected;
                        }

                    });
                    collectionFilter.addEventListener('change', (event) =>
                    {
                        const allItems = [...customFilterBrowser.querySelectorAll('captioned-thumbnail')];

                        const filters = event.detail.filters;
                        if(filters.length == 0)
                        {
                            for(let i = 0; i < allItems.length; i++)
                            {
                                allItems[i].classList.remove('match');
                            }
                            return;
                        }

                        const items = collectionFilter.filterItems(allItems).map((match) => match.item);
                        for(let i = 0; i < allItems.length; i++)
                        {
                            allItems[i].classList.remove('match');
                            if(items.indexOf(allItems[i]) > -1)
                            {
                                allItems[i].classList.add('match');
                            }
                        }
                    });
                });       
            </script>
        </article>
        <article class="events">
            <h2>Events</h2>
            <div class="description">
                <p>The <code>&lt;collection-browser&gt;</code> element dispatches three event types: <code>change</code>, <code>category</code>, and <code>add</code></p>
                <p>Whenever an item is selected, the <code>change</code> event is dispatched.</p>
                <p>Whenever a category is selected, the <code>category</code> event is dispatched.</p>
                <p>Whenever the add button is clicked, the <code>add</code> event is dispatched.</p>
                <p>In the example below, each event is handled by adding an entry with the event's details in the entry log:</p>    
            </div>
            <div class="example">
                <style>
                    article.events collection-browser
                    {
                        margin: 1em;
                        width: 600px;
                    }
                </style>
                <collection-browser multi>
                    <div slot="category">Category 1</div>
                    <div slot="category">Category 2</div>
                    <div slot="category">Category 3</div>
                    <div slot="category">Category 4</div>
                    <div>A</div>
                    <div>B</div>
                    <div>C</div>
                    <div>D</div>
                    <div>E</div>
                    <div>F</div>
                    <div>G</div>
                    <div>H</div>
                    <div>I</div>
                    <div>J</div>
                    <div>K</div>
                </collection-browser>
            </div>
            <div class="log">
                <header>
                    <span class="title">Event Log</span>
                </header>
                <ul></ul>
            </div>
            <script type="module">
                const eventsExample = document.querySelector('article.events');
                const eventsBrowser = eventsExample.querySelector('collection-browser');
                const eventsLog = document.querySelector('article.events .log ul');
                document.addEventListener('DOMContentLoaded', () =>
                {
                    eventsBrowser.addEventListener('change', (event) =>
                    {
                        const result = {
                            newSelection: event.detail.newSelection.textContent,
                            previousSelection: event.detail.previousSelection.map((item) =>
                            {
                                return item.textContent;
                            }),
                            shift: event.detail.shift,
                            ctrl: event.detail.ctrl,
                            alt: event.detail.alt,
                        }
                        logEventResult(result);
                    });
                    

                    eventsBrowser.addEventListener('category', (event) =>
                    {
                        const result = {
                            selected: event.detail.selected.textContent
                        }
                        logEventResult(result);
                    });

                    eventsBrowser.findElement('add-button').addEventListener('click', (event) =>
                    {
                        logEventResult(`[Add Button: onClick]`);
                    });
                });        
                function logEventResult(result)
                {
                    const entry = document.createElement('li');
                    entry.textContent = JSON.stringify(result, null, 2);
                    entry.classList.add('entry');
                    eventsLog.append(entry);
                }        
            </script>
        </article>
        <article class="nested-slots">
            <h2>Nested Slots</h2>
            <div class="description">
                <p>The <code>&lt;collection-browser&gt;</code> element dispatches three event types: <code>change</code>, <code>category</code>, and <code>add</code></p>
                <p>Whenever an item is selected, the <code>change</code> event is dispatched.</p>
                <p>Whenever a category is selected, the <code>category</code> event is dispatched.</p>
                <p>Whenever the add button is clicked, the <code>add</code> event is dispatched.</p>
                <p>In the example below, each event is handled by adding an entry with the event's details in the entry log:</p>    
            </div>
            <div class="example">
                <style>
                    article.nested-slots collection-browser
                    {
                        margin: 1em;
                        width: 600px;
                    }
                </style>
                <shadow-wrapper-2 multi>
                    <h5 slot="navigation-header">Drives</h5>
                    
                    <div slot="category" data-category="drive-1">Drive 1</div>
                    <div slot="category" data-category="drive-2">Drive 2</div>
                    <div slot="category" data-category="drive-3">Drive 3</div>
                    <div slot="category" data-category="drive-4">Drive 4</div>

                    <captioned-thumbnail edit select data-category="drive-1">First</captioned-thumbnail>
                    <captioned-thumbnail edit select data-category="drive-1">Second</captioned-thumbnail>
                    <captioned-thumbnail edit select data-category="drive-1">Third</captioned-thumbnail>
                    <captioned-thumbnail edit select data-category="drive-1">Fourth</captioned-thumbnail>
                    <captioned-thumbnail edit select data-category="drive-1">Fifth</captioned-thumbnail>
                    <captioned-thumbnail edit select data-category="drive-1">Sixth</captioned-thumbnail>
                    <captioned-thumbnail edit select data-category="drive-2">Seventh</captioned-thumbnail>
                    <captioned-thumbnail edit select data-category="drive-2">Eigth</captioned-thumbnail>
                    <captioned-thumbnail edit select data-category="drive-2">Ninth</captioned-thumbnail>
                    <captioned-thumbnail edit select data-category="drive-2">Tenth</captioned-thumbnail>
                    <captioned-thumbnail edit select data-category="drive-2">Eleventh</captioned-thumbnail>
                    <captioned-thumbnail edit select data-category="drive-2">Twelfth</captioned-thumbnail>
                    
                    <captioned-thumbnail edit select data-category="drive-3">Thirteenth</captioned-thumbnail>
                    <captioned-thumbnail edit select data-category="drive-3">Fourteenth</captioned-thumbnail>
                    <captioned-thumbnail edit select data-category="drive-3">Fifteenth</captioned-thumbnail>
                    <captioned-thumbnail edit select data-category="drive-3">Sixteenth</captioned-thumbnail>
                    <captioned-thumbnail edit select data-category="drive-3">Seventeenth</captioned-thumbnail>
                    <captioned-thumbnail edit select data-category="drive-3">Eighteenth</captioned-thumbnail>
                    <captioned-thumbnail edit select data-category="drive-4">Ninteenth</captioned-thumbnail>
                    <captioned-thumbnail edit select data-category="drive-4">Twentieth</captioned-thumbnail>
                    <captioned-thumbnail edit select data-category="drive-4">Twenty-First</captioned-thumbnail>
                    <captioned-thumbnail edit select data-category="drive-4">Twenty-Second</captioned-thumbnail>
                    <captioned-thumbnail edit select data-category="drive-4">Twenty-Third</captioned-thumbnail>
                    <captioned-thumbnail edit select data-category="drive-4">Twenty-Fourth</captioned-thumbnail>
                </shadow-wrapper-2>
            </div>
            <div class="log">
                <header>
                    <span class="title">Event Log</span>
                </header>
                <ul></ul>
            </div>
            <script type="module">
                import './shadow-wrapper.js';
                import './shadow-wrapper-2.js';
                import { CaptionedThumbnailElement } from './captioned-thumbnail.min.js';
                const nestedSlotsExample = document.querySelector('article.nested-slots');
                const nestedSlotsWrapper = nestedSlotsExample.querySelector('shadow-wrapper-2');
                const nestedSlotsBrowser = nestedSlotsWrapper.shadowRoot.querySelector('shadow-wrapper').shadowRoot.querySelector('collection-browser');
                const nestedSlotsLog = document.querySelector('article.nested-slots .log ul');
                document.addEventListener('DOMContentLoaded', () =>
                {
                    nestedSlotsBrowser.addEventListener('change', (event) =>
                    {
                        if(event.target instanceof CaptionedThumbnailElement
                        && (event.detail.method == "click" || event.detail.method == "input"))
                        {
                            // an input event or a click event will trigger
                            // changes that the collection browser already handles.
                            // those events can be prevented on the thumbnail element.
                            event.preventDefault();
                        }
                        

                        // if this change event is from the
                        // browser, manage the selections
                        if(event.target == nestedSlotsBrowser)
                        {
                            event.preventDefault();
                            // de-select other captioned thumbnail elements 
                            // to prevent multiple selection
                            event.detail.previousSelection.forEach(item => item.isSelected = false);

                            // set current selection
                            event.detail.newSelection.isSelected = !event.detail.newSelection.isSelected;
                        
                            const result = {
                                newSelection: event.detail.newSelection?.textContent,
                                previousSelection: event.detail.previousSelection?.map((item) =>
                                {
                                    return item.textContent;
                                }),
                                shift: event.detail.shift,
                                ctrl: event.detail.ctrl,
                                alt: event.detail.alt,
                            }
                            logEventResult(result);
                        }
                    });
                    

                    nestedSlotsBrowser.addEventListener('category', (event) =>
                    {
                        const result = {
                            newSelection: event.detail.selected.textContent
                        }
                        logEventResult(result);
                    });

                    nestedSlotsBrowser.findElement('add-button').addEventListener('click', (event) =>
                    {
                        logEventResult(`[Add Button: onClick]`);
                    });
                });        
                function logEventResult(result)
                {
                    const entry = document.createElement('li');
                    entry.textContent = JSON.stringify(result, null, 2);
                    entry.classList.add('entry');
                    nestedSlotsLog.append(entry);
                }        
            </script>
        </article>
    </main>
    <script type="module" src="../vanilla/collection-browser.js"></script>
    <script type="module" src="./captioned-thumbnail.min.js"></script>
    <script type="module" src="./collection-filter.min.js"></script>
</body>
</html>